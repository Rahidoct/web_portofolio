<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Middle Way - Real Estate Marketplace</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <style>
    /* GENERAL STYLES */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root {
      --primary-color: #0d162a;
      --secondary-color: #6c757d;
      --accent-color: #FD5C47;
      --background-color: #f7f7f8;
      --white-color: #fff;
      --border-color: #e9e9e9;
      --main-font: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    }
    body {
      font-family: var(--main-font);
      background: var(--white-color);
      color: var(--primary-color);
      line-height: 1.6;
    }
    .container { max-width: 1440px; margin: 0 auto; padding: 0 40px; }

    /* HEADER */
    .header { background: var(--white-color); box-shadow: 0 2px 10px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 1000; }
    .header-content { display: flex; justify-content: space-between; align-items: center; padding: 1rem 0; }
    .logo { display: flex; align-items: center; gap: 10px; font-size: 24px; font-weight: 700; color: var(--primary-color); text-decoration: none; }
    .logo i { color: var(--accent-color); }
    .nav-tabs { display: flex; background: #f0f0f0; border-radius: 8px; padding: 4px; gap: 4px; }
    .nav-tab { padding: 10px 20px; border: none; background: none; border-radius: 6px; cursor: pointer; font-size: 14px; font-weight: 500; color: var(--secondary-color); transition: all 0.3s ease; }
    .nav-tab.active { background: var(--white-color); color: var(--primary-color); box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
    .user-profile { display: flex; align-items: center; gap: 15px; }
    .header-icons { display: flex; gap: 20px; }
    .header-icons i { font-size: 18px; color: var(--secondary-color); cursor: pointer; transition: color 0.3s ease; }
    .header-icons i:hover { color: var(--accent-color); }
    .profile-info { display: flex; align-items: center; gap: 12px; cursor: pointer; }
    .profile-avatar { width: 40px; height: 40px; border-radius: 50%; background: linear-gradient(45deg, var(--accent-color), #ff7b5a); display: flex; align-items: center; justify-content: center; color: white; font-weight: 600; }
    .profile-details h4 { font-size: 14px; font-weight: 600; margin:0; }
    .profile-details p { font-size: 12px; color: var(--secondary-color); margin:0; }
    .menu-toggle { display: none; font-size: 20px; cursor: pointer; }
    
    /* SEARCH SECTION */
    .search-section { padding: 30px 0; }
    .search-controls { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; gap: 20px; }
    .action-tabs { display: flex; gap: 10px; }
    .action-tab { padding: 12px 24px; border: none; background: none; font-size: 16px; font-weight: 600; color: var(--secondary-color); cursor: pointer; border-bottom: 3px solid transparent; transition: all 0.3s ease; }
    .action-tab.active { color: var(--primary-color); border-bottom-color: var(--accent-color); }
    .search-box { display: flex; align-items: center; gap: 15px; flex: 1; }
    .search-input-wrapper { position: relative; }
    .search-input { width: 300px; padding: 12px 20px 12px 45px; border: 1px solid var(--border-color); border-radius: 10px; font-size: 14px; outline: none; transition: border-color 0.3s ease; }
    .search-input:focus { border-color: var(--accent-color); }
    .search-input-wrapper i { position: absolute; left: 15px; top: 50%; transform: translateY(-50%); color: var(--secondary-color); }
    .filter-btn { padding: 12px; border: 1px solid var(--border-color); background: var(--white-color); border-radius: 10px; cursor: pointer; transition: all 0.3s ease; }
    .filter-btn:hover { border-color: var(--accent-color); color: var(--accent-color); }
    .view-toggle { display: flex; background: #f0f0f0; border-radius: 8px; padding: 4px; }
    .view-btn { padding: 8px 18px; border: none; background: none; border-radius: 6px; font-size: 14px; font-weight: 500; cursor: pointer; color: var(--secondary-color); transition: all 0.3s ease; display: flex; align-items: center; gap: 8px; }
    .view-btn.active { background: var(--white-color); color: var(--primary-color); box-shadow: 0 2px 4px rgba(0,0,0,0.1); font-weight: 600; }

    /* MAIN CONTENT & LISTINGS */
    .main-content { display: grid; grid-template-columns: minmax(0, 1fr) 450px; gap: 40px; padding: 30px 0; }
    .listings-header { margin-bottom: 20px; display: flex; flex-wrap: wrap; justify-content: space-between; align-items: center; gap: 15px;}
    .listings-header h2 { font-size: 24px; font-weight: 700; margin-bottom: 4px; }
    .listings-header p { color: var(--secondary-color); }
    .sort-controls { display: flex; justify-content: flex-end; }
    .sort-select { padding: 8px 12px; border: none; border-radius: 8px; background: var(--white-color); font-size: 14px; outline: none; font-weight: 500; }

    /* PROPERTY CARD */
    .property-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 25px; }
    .property-card { background: var(--white-color); border-radius: 20px; overflow: hidden; border: 1px solid var(--border-color); transition: all 0.3s ease; }
    .property-card:hover { transform: translateY(-5px); box-shadow: 0 12px 30px rgba(0,0,0,0.1); }
    .card-image { position: relative; height: 220px; }
    .card-image img { width: 100%; height: 100%; object-fit: cover; }
    .photo-count { position: absolute; top: 15px; right: 15px; background: rgba(0,0,0,0.4); backdrop-filter: blur(5px); color: white; padding: 5px 12px; border-radius: 20px; font-size: 12px; font-weight: 500; display: flex; align-items: center; gap: 6px; }
    .agent-overlay { position: absolute; bottom: 12px; left: 12px; right: 12px; background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(10px); padding: 10px; border-radius: 12px; display: flex; align-items: center; justify-content: space-between; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
    .agent-info { display: flex; align-items: center; gap: 10px; }
    .agent-avatar img { width: 35px; height: 35px; border-radius: 50%; }
    .agent-details h4 { font-size: 14px; font-weight: 600; margin: 0; }
    .agent-details p { font-size: 12px; color: var(--secondary-color); margin: 0; }
    .agent-overlay .fas.fa-check-circle { color: #3498db; }
    .card-content { padding: 20px; }
    .card-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 12px; }
    .property-status { font-size: 13px; font-weight: 500; color: var(--primary-color); display: flex; align-items: center; gap: 6px; }
    .property-status .dot { width: 8px; height: 8px; background: var(--accent-color); border-radius: 50%; }
    .property-price { font-size: 22px; font-weight: 700; color: var(--primary-color); margin-top: 4px; }
    .card-actions { display: flex; gap: 15px; font-size: 18px; color: var(--secondary-color); }
    .property-details { display: flex; gap: 20px; margin-top: 15px; font-size: 14px; color: var(--secondary-color); }
    .property-details span { display: flex; align-items: center; gap: 8px; }
    .property-address { font-size: 14px; color: var(--secondary-color); margin-top: 8px; border-bottom: 1px solid var(--border-color); padding-bottom: 15px; }
    .listed-by { font-size: 13px; color: var(--secondary-color); margin-top: 15px; }

    /* MAP SECTION */
    .map-container { position: sticky; top: 110px; height: calc(100vh - 140px); border-radius: 20px; overflow: hidden; }
    #map { width: 100%; height: 100%; background: #f0f0f0; }
    .leaflet-control-zoom, .map-ui-btn { border: 1px solid var(--border-color) !important; border-radius: 50% !important; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .leaflet-control-zoom a, .map-ui-btn { color: var(--primary-color) !important; border-radius: 50% !important; width: 40px !important; height: 40px !important; line-height: 40px !important; font-size: 16px; }
    .map-ui-controls { position: absolute; top: 20px; left: 20px; z-index: 401; display: flex; flex-direction: column; gap: 10px; }

    /* MAP MARKER, TOOLTIP, POPUP */
    .map-marker-dot { background-color: var(--accent-color); border: 2px solid var(--white-color); border-radius: 50%; box-shadow: 0 2px 5px rgba(0,0,0,0.2); }
    .price-tooltip { background: var(--primary-color); border: none; box-shadow: 0 4px 10px rgba(0,0,0,0.25); border-radius: 20px; color: var(--white-color); font-family: var(--main-font); font-weight: 600; font-size: 14px; padding: 6px 12px; }
    .leaflet-tooltip-top.price-tooltip::before { display: none; }
    .leaflet-popup-content-wrapper { background: var(--white-color); border-radius: 24px !important; box-shadow: 0 10px 35px rgba(0,0,0,0.15) !important; }
    .leaflet-popup-content { margin: 0 !important; width: auto !important; }
    .leaflet-popup-close-button, .leaflet-popup-tip-container { display: none; }
    .map-popup-card { display: flex; width: 340px; height: 150px; border-radius: 16px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.12); background: white; overflow: hidden; }
    .map-popup-card .image-container { width: 40%; flex-shrink: 0; }
    .map-popup-card .image-container img { width: 100%; height: 100%; object-fit: cover; }
    .map-popup-card .info { width: 60%; padding: 12px; display: flex; flex-direction: column; justify-content: space-around; }
    .map-popup-card .header { background: none; box-shadow: none; display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 8px; }
    .map-popup-card .status { font-size: 10px; color: var(--primary-color); font-weight: 600; display: flex; align-items: center; gap: 4px; margin: 0; text-transform: uppercase; letter-spacing: 0.5px; }
    .map-popup-card .status .dot { width: 6px; height: 6px; background: var(--accent-color); border-radius: 50%; }
    .map-popup-card .heart-icon { font-size: 16px; color: var(--accent-color); cursor: pointer; }
    .map-popup-card .price { font-size: 14px; font-weight: 700; color: var(--primary-color); line-height: 1.2; margin-bottom: 6px; }
    .map-popup-card .details { display: flex; flex-wrap: wrap; gap: 8px; font-size: 11px; color: var(--secondary-color); margin-bottom: 6px; }
    .map-popup-card .details span { display: flex; align-items: center; gap: 4px; }
    .map-popup-card .address { font-size: 11px; color: var(--secondary-color); line-height: 1.3; margin: 0; }

    /* FOOTER STYLES */
    .site-footer { background-color: var(--primary-color); color: #a9b3c6; padding: 60px 0 20px 0; margin-top: 50px; }
    .footer-top { display: grid; grid-template-columns: 1.5fr 2fr; gap: 50px; padding-bottom: 40px; border-bottom: 1px solid #2c3e50; }
    .footer-about .logo { color: var(--white-color); margin-bottom: 20px; }
    .footer-about p { font-size: 14px; line-height: 1.8; margin-bottom: 20px; }
    .social-links a { display: inline-flex; align-items: center; justify-content: center; width: 40px; height: 40px; border-radius: 50%; background-color: #2c3e50; color: var(--white-color); text-decoration: none; margin-right: 10px; transition: all 0.3s ease; }
    .social-links a:hover { background-color: var(--accent-color); }
    .footer-links-group { display: grid; grid-template-columns: repeat(3, 1fr); gap: 30px; }
    .footer-links h4 { font-size: 16px; font-weight: 600; color: var(--white-color); margin-bottom: 20px; }
    .footer-links ul { list-style: none; }
    .footer-links li { margin-bottom: 12px; }
    .footer-links a { color: #a9b3c6; text-decoration: none; font-size: 14px; transition: color 0.3s ease; }
    .footer-links a:hover { color: var(--white-color); }
    .footer-bottom { padding-top: 20px; text-align: center; font-size: 13px; }

    /* =================================== */
    /* ===== RESPONSIVE MEDIA QUERIES ==== */
    /* =================================== */

    /* LAPTOP & LAYAR LEBAR KECIL (1200px) */
    @media (max-width: 1200px) {
      .main-content {
        grid-template-columns: minmax(0, 1fr) 400px;
        gap: 30px;
      }
      .nav-tab { padding: 8px 15px; }
      .profile-details { display: none; } /* Sembunyikan email di layar lebih kecil */
    }

    /* TABLET (992px) - TITIK KRUSIAL PERUBAHAN LAYOUT */
    @media (max-width: 992px) {
      .container { padding: 0 20px; }
      .nav-tabs { display: none; } /* Sembunyikan navigasi utama */
      .menu-toggle { display: block; } /* Tampilkan ikon hamburger */
      
      .main-content {
        grid-template-columns: 1fr; /* Layout menjadi 1 kolom */
      }
      .map-container {
        position: relative;
        top: 0;
        height: 60vh; /* Tinggi peta saat mode single view */
        min-height: 450px;
        margin-top: 30px;
      }
      /* Logika Sembunyi/Tampil akan di-handle oleh JavaScript */
      .listings-section.hidden, .map-container.hidden {
        display: none;
      }
      .footer-top {
        grid-template-columns: 1fr;
        gap: 40px;
      }
    }

    /* TABLET KECIL & HP LANDSCAPE (768px) */
    @media (max-width: 768px) {
      .header-icons { display: none; } /* Sembunyikan ikon notif dan pesan */
      .search-controls { flex-direction: column; align-items: stretch; }
      .search-box { justify-content: center; }
      .action-tabs, .view-toggle { justify-content: center; }
      .action-tab { padding: 10px 18px; font-size: 15px; }
      .footer-links-group { grid-template-columns: repeat(2, 1fr); }
    }

    /* HP PORTRAIT (576px) */
    @media (max-width: 576px) {
      .logo { font-size: 20px; }
      .profile-info { gap: 8px; }
      .profile-avatar { width: 35px; height: 35px; }
      .action-tabs { gap: 0; width: 100%; display: grid; grid-template-columns: repeat(3, 1fr); }
      .action-tab { text-align: center; }
      .listings-header { text-align: center; }
      .listings-header div, .sort-controls { width: 100%; justify-content: center; }
      .property-details { flex-wrap: wrap; gap: 15px; }
      .footer-links-group { grid-template-columns: 1fr; }
      .footer-top { text-align: center; }
      .social-links { margin-bottom: 20px; }
    }
  </style>
</head>
<body>
  
  <header class="header">
    <div class="container">
      <div class="header-content">
        <a href="#" class="logo"><i class="fas fa-home"></i>Middle Way</a>
        <nav class="nav-tabs">
          <button class="nav-tab active" data-type="house">House</button>
          <button class="nav-tab" data-type="villa">Villa</button>
          <button class="nav-tab" data-type="apartment">Apartment</button>
          <button class="nav-tab" data-type="guesthouse">Guesthouse</button>
        </nav>
        <div class="user-profile">
          <div class="header-icons">
            <i class="far fa-comment-dots"></i>
            <i class="far fa-bell"></i>
          </div>
          <div class="profile-info">
            <div class="profile-avatar">RV</div>
            <div class="profile-details">
              <h4>Ryan Vaccaro</h4>
              <p>ryanvac@gmail.com</p>
            </div>
          </div>
          <i class="fas fa-bars menu-toggle"></i>
        </div>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="search-section">
      <div class="search-controls">
        <div class="action-tabs">
          <button class="action-tab" data-action="rent">Rent</button>
          <button class="action-tab active" data-action="buy">Buy</button>
          <button class="action-tab" data-action="sell">Sell</button>
        </div>
        <div class="search-box">
          <div class="search-input-wrapper">
            <i class="fas fa-search"></i>
            <input type="text" class="search-input" placeholder="Seattle, WA">
          </div>
          <button class="filter-btn"><i class="fas fa-sliders-h"></i></button>
        </div>
        <div class="view-toggle">
          <button class="view-btn" data-view="grid"><i class="fas fa-th-large"></i> Grid</button>
          <button class="view-btn active" data-view="map"><i class="fas fa-map-marked-alt"></i> Map</button>
        </div>
      </div>
    </section>

    <div class="main-content">
      <section class="listings-section">
        <div class="listings-header">
          <div>
            <h2>Seattle, WA Accommodation</h2>
            <p><span id="property-count"></span> homes found</p>
          </div>
          <div class="sort-controls">
            <select class="sort-select">
              <option value="latest">Sort by: Latest</option>
              <option value="price-low">Price: Low to High</option>
              <option value="price-high">Price: High to Low</option>
            </select>
          </div>
        </div>
        <div class="property-grid" id="property-grid"></div>
      </section>

      <aside class="map-container">
        <div id="map"></div>
        <div class="map-ui-controls">
            <button class="map-ui-btn"><i class="fas fa-expand"></i></button>
            <button class="map-ui-btn"><i class="fas fa-layer-group"></i></button>
        </div>
      </aside>
    </div>
  </main>

    <footer class="site-footer">
    <div class="container">
      <div class="footer-top">
        <div class="footer-about">
          <a href="#" class="logo"><i class="fas fa-home"></i>Middle Way</a>
          <p>Platform terkemuka untuk menemukan properti impian Anda. Kami menyediakan data dan pengetahuan untuk membantu Anda menemukan tempat yang tepat.</p>
          <div class="social-links">
            <a href="#"><i class="fab fa-facebook-f"></i></a>
            <a href="#"><i class="fab fa-twitter"></i></a>
            <a href="#"><i class="fab fa-instagram"></i></a>
            <a href="#"><i class="fab fa-linkedin-in"></i></a>
          </div>
        </div>
        <div class="footer-links-group">
          <div class="footer-links">
            <h4>Navigasi</h4>
            <ul>
              <li><a href="#">Beranda</a></li>
              <li><a href="#">Properti</a></li>
              <li><a href="#">Agen</a></li>
              <li><a href="#">Blog</a></li>
            </ul>
          </div>
          <div class="footer-links">
            <h4>Layanan</h4>
            <ul>
              <li><a href="#">Beli Rumah</a></li>
              <li><a href="#">Sewa Rumah</a></li>
              <li><a href="#">Jual Rumah</a></li>
              <li><a href="#">KPR</a></li>
            </ul>
          </div>
          <div class="footer-links">
            <h4>Dukungan</h4>
            <ul>
              <li><a href="#">Hubungi Kami</a></li>
              <li><a href="#">FAQ</a></li>
              <li><a href="#">Syarat & Ketentuan</a></li>
              <li><a href="#">Kebijakan Privasi</a></li>
            </ul>
          </div>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2024 Middle Way. Semua Hak Cipta Dilindungi.</p>
      </div>
    </div>
  </footer>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script>
    const properties = [
        { id: 1, image: "https://images.pexels.com/photos/106399/pexels-photo-106399.jpeg?auto=compress&cs=tinysrgb&w=600", photos: 20, status: "For sale", price: 389781, beds: 4, baths: 2, sqft: 1090, address: "6391 Elgin St. Celina, Delaware 10299", listedBy: "Turja Design Group, Inc.", agent: { name: "Brandon Levin", phone: "(480) 555-0103", avatar: "https://i.pravatar.cc/35?u=brandon" }, type: "house", location: { lat: 47.6205, lng: -122.3493 } },
        { id: 2, image: "https://images.pexels.com/photos/323780/pexels-photo-323780.jpeg?auto=compress&cs=tinysrgb&w=600", photos: 12, status: "For sale", price: 160581, beds: 5, baths: 4, sqft: 2240, address: "2715 Ash Dr. San Jose, South Dakota", listedBy: "SENDAS Estate Group, Inc.", agent: { name: "Gustavo Calzoni", phone: "(808) 274-0111", avatar: "https://i.pravatar.cc/35?u=gustavo" }, type: "villa", location: { lat: 47.6097, lng: -122.3331 } },
        { id: 3, image: "https://images.pexels.com/photos/209296/pexels-photo-209296.jpeg?auto=compress&cs=tinysrgb&w=600", photos: 17, status: "For sale", price: 778100, beds: 4, baths: 2, sqft: 1090, address: "4140 Parker Rd, New Mexico 31134", listedBy: "Stark Real Estate", agent: { name: "Chance Dorwart", phone: "(209) 009-0104", avatar: "https://i.pravatar.cc/35?u=chance" }, type: "house", location: { lat: 47.6145, lng: -122.3119, selected: true } },
        { id: 4, image: "https://images.pexels.com/photos/259588/pexels-photo-259588.jpeg?auto=compress&cs=tinysrgb&w=600", photos: 15, status: "For sale", price: 350241, beds: 3, baths: 3, sqft: 1800, address: "1901 Thornridge Cir. Shiloh, Hawaii", listedBy: "Quantum Properties", agent: { name: "Craig Herwitz", phone: "(629) 172-0129", avatar: "https://i.pravatar.cc/35?u=craig" }, type: "guesthouse", location: { lat: 47.5952, lng: -122.3321 } }
    ];

    const gridContainer = document.getElementById("property-grid");
    const propertyCountEl = document.getElementById("property-count");
    const navTabs = document.querySelectorAll(".nav-tab");
    const viewToggleBtns = document.querySelectorAll('.view-btn');
    const listingsSection = document.querySelector('.listings-section');
    const mapContainer = document.querySelector('.map-container');
    
    let map;
    let markers = [];

    // FUNGSI INTI (render, filter, dll. tidak berubah banyak)
    function initMap() {
        map = L.map('map', { zoomControl: false }).setView([47.61, -122.33], 13);
        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
            attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',
            subdomains: 'abcd', maxZoom: 20
        }).addTo(map);
        L.control.zoom({ position: 'bottomright' }).addTo(map);
    }
    
    function renderProperties(props) {
        gridContainer.innerHTML = "";
        props.forEach(property => {
            const card = document.createElement("div");
            card.className = "property-card";
            card.innerHTML = `
                <div class="card-image"> <img src="${property.image}" alt="${property.address}"> <div class="photo-count"><i class="fas fa-camera"></i> ${property.photos}</div> <div class="agent-overlay"> <div class="agent-info"> <div class="agent-avatar"><img src="${property.agent.avatar}" alt="${property.agent.name}"></div> <div class="agent-details"> <h4>${property.agent.name}</h4> <p>${property.agent.phone}</p> </div> </div> <i class="fas fa-check-circle"></i> </div> </div>
                <div class="card-content"> <div class="card-header"> <p class="property-status"><span class="dot"></span> ${property.status}</p> <div class="card-actions"> <i class="far fa-bookmark"></i> <i class="far fa-heart"></i> </div> </div> <h3 class="property-price">$${property.price.toLocaleString()}</h3> <p class="property-address">${property.address}</p> <div class="property-details"> <span><i class="fas fa-bed"></i> ${property.beds} bed</span> <span><i class="fas fa-bath"></i> ${property.baths} bath</span> <span><i class="fas fa-ruler-combined"></i> ${property.sqft} sqft</span> </div> <p class="listed-by">Listed by ${property.listedBy}</p> </div>
            `;
            gridContainer.appendChild(card);
        });
        propertyCountEl.textContent = props.length;
    }

    function renderMapMarkers(props) {
        markers.forEach(marker => map.removeLayer(marker));
        markers = [];
        props.forEach(property => {
            const dotIcon = L.divIcon({ className: 'map-marker-dot', iconSize: [14, 14], iconAnchor: [7, 7] });
            const marker = L.marker([property.location.lat, property.location.lng], { icon: dotIcon }).addTo(map);
            marker.bindTooltip(`$${property.price.toLocaleString()}`, { permanent: true, direction: 'top', offset: [0, -10], className: 'price-tooltip' });
            const popupContent = `
                <div class="map-popup-card"> <div class="image-container"><img src="${property.image}" alt="${property.address}"></div> <div class="info"> <div class="header"> <p class="status"><span class="dot"></span> ${property.status}</p> <i class="far fa-heart heart-icon"></i> </div> <div> <h3 class="price">$${property.price.toLocaleString()}</h3> <div class="details"> <span><i class="fas fa-bed"></i> ${property.beds} bed</span> <span><i class="fas fa-bath"></i> ${property.baths} bath</span> <span><i class="fas fa-ruler-combined"></i> ${property.sqft} sqft</span> </div> <p class="address">${property.address}</p> </div> </div> </div>
            `;
            marker.bindPopup(popupContent, { offset: L.point(0, -10) });
            if(property.selected) marker.openPopup();
            markers.push(marker);
        });
    }

    function filterProperties() {
        const activeTab = document.querySelector(".nav-tab.active");
        const type = activeTab ? activeTab.getAttribute("data-type") : "house"; // Default
        const filteredProperties = properties.filter(p => p.type === type);
        renderProperties(filteredProperties);
        renderMapMarkers(filteredProperties);
    }
    
    // ===== LOGIKA BARU UNTUK TAMPILAN RESPONSIVE =====
    function updateLayout() {
      const activeView = document.querySelector('.view-btn.active').dataset.view;
      const screenWidth = window.innerWidth;

      if (screenWidth <= 992) {
        // Pada layar kecil, hanya satu view yang bisa tampil
        if (activeView === 'map') {
          mapContainer.classList.remove('hidden');
          listingsSection.classList.add('hidden');
          // Refresh ukuran peta agar tidak rusak
          if(map) map.invalidateSize();
        } else { // 'grid'
          mapContainer.classList.add('hidden');
          listingsSection.classList.remove('hidden');
        }
      } else {
        // Pada layar besar, tampilkan keduanya
        mapContainer.classList.remove('hidden');
        listingsSection.classList.remove('hidden');
        if(map) map.invalidateSize();
      }
    }

    navTabs.forEach(tab => {
        tab.addEventListener("click", () => {
            navTabs.forEach(t => t.classList.remove("active"));
            tab.classList.add("active");
            filterProperties();
        });
    });

    viewToggleBtns.forEach(btn => {
      btn.addEventListener('click', () => {
        viewToggleBtns.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        updateLayout();
      });
    });

    // Panggil saat window di-resize
    window.addEventListener('resize', updateLayout);

    // Inisialisasi awal
    document.addEventListener("DOMContentLoaded", () => {
        initMap();
        filterProperties();
        // Set view awal berdasarkan state tombol
        updateLayout();
    });
  </script>
</body>
</html>